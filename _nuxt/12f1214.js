(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{429:function(e,t,n){"use strict";n.r(t);n(46),n(86),n(155),n(23),n(60),n(50),n(67),n(38);var r=n(10),o=n(13),c=n(21),l=n(24),f=n(22),v=n(11),h=n(6),d=n(65),m=n(83),y=n.n(m);function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(v.a)(e);if(t){var o=Object(v.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var _=function(e,t,n,desc){var r,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(h.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(c=(o<3?r(c):o>3?r(t,n,c):r(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c};function x(html){var div=document.createElement("div");return div.innerHTML=html,div.textContent||div.textContent||""}var C=function(e){Object(l.a)(d,e);var t,n,f,v,h=I(d);function d(){var e;return Object(o.a)(this,d),(e=h.apply(this,arguments)).baseUrl="https://nakamura196.github.io/i3",e.manifestDownloaded=!1,e.curationUriGenerated=!1,e.result=!1,e.curationUri="",e.collectionProgress="",e.canvasProgress="",e.manifestProgress="",e.manifest="",e.generating=!1,e.viewers=[{url:"http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?curation=",icon:e.baseUrl+"/img/icons/icp-logo.svg",label:"IIIF Curation Viewerで閲覧する"},{url:"http://codh.rois.ac.jp/software/iiif-curation-player/demo/?curation=",icon:e.baseUrl+"/img/icons/icp-logo.svg",label:"IIIF Curation Playerで閲覧する"},{url:"http://self-museum.cultural.jp/?collection=",icon:e.baseUrl+"/img/icons/favicon.ico",label:"セルフミュージアムで閲覧する"},{url:"https://nakamura196.github.io/icc2/?u=",icon:e.baseUrl+"/img/icons/sn.png",label:"IIIF Multi Viewerで閲覧する"},{url:e.baseUrl+"/map/?curation=",icon:e.baseUrl+"/img/icons/sn.png",label:"IIIF Curation Map Searchで閲覧する"}],e}return Object(c.a)(d,[{key:"head",value:function(){return{titleTemplate:null,title:this.$t("IIIF Converter")}}},{key:"mounted",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,c,l,f,v,h,d,m,y,I,_=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.$route.query.u){e.next=3;break}return e.abrupt("return");case 3:return n=t+"",this.manifest=n,this.manifestDownloaded=!0,e.next=8,this.$utils.getData(n);case 8:if(r=e.sent,o=r["@type"],c=[],!(l="sc:Collection"===o)){e.next=18;break}return e.next=15,this.getCollection(n,c);case 15:c=e.sent,e.next=19;break;case 18:c=[n];case 19:if(0!==c.length){e.next=22;break}return this.manifestDownloaded=!1,e.abrupt("return");case 22:return this.curationUriGenerated=!0,e.next=25,this.create({});case 25:if(e.t0=e.sent,e.t0){e.next=28;break}e.t0="";case 28:f=e.t0,this.curationUri=f,h={"@context":["http://iiif.io/api/presentation/2/context.json","http://codh.rois.ac.jp/iiif/curation/1/context.json"],"@type":"cr:Curation","@id":f,label:"Automatic curation by IIIF Converter",viewingHint:"grid",selections:v=[]},d=[],m=1,y=regeneratorRuntime.mark((function e(t){var n,r,o,h,i,canvas,y,I,label,C,w,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c[t],_.manifestProgress="3/4 "+_.$t("Manifest Data Acquisition Progress")+" "+(t+1)+"/"+c.length,e.next=4,_.$utils.getData(n);case 4:r=e.sent,o=[],v.push({"@id":f+"/range"+(t+1),"@type":"sc:Range",label:"Automatic curation by IIIF Converter",members:o,within:{"@id":n,"@type":"sc:Manifest",label:r.label}}),h=r.sequences[0].canvases,i=0;case 9:if(!(i<h.length)){e.next=22;break}if(canvas=h[i],_.canvasProgress=_.$t("Canvas Data Acquisition Progress")+" "+(i+1)+"/"+h.length,!canvas.otherContent){e.next=19;break}return e.next=15,_.$utils.getData(canvas.otherContent[0]["@id"]);case 15:if(y=e.sent){e.next=18;break}return e.abrupt("continue",19);case 18:d.push(y);case 19:i++,e.next=9;break;case 22:if(d.length>0&&!l)d.map((function(e){for(var t=e.resources,n=0;n<t.length;n++){var r=t[n],c=r.on;Array.isArray(c)&&(c=c[0].full+"#"+c[0].selector.default.value);var l=r.resource,f=[],text="";if(Array.isArray(l))for(var v=0;v<l.length;v++){var h=l[v],d=x(h.chars);""===d&&(d=h.chars),f.push({label:h["@type"],value:d}),"dctypes:Text"===h["@type"]&&(text=d)}else{var y=l,I=x(y.chars);""===I&&(I=y.chars),f.push({label:y["@type"],value:I}),text=I}var _={"@id":c,"@type":"sc:Canvas",label:text,description:"[Annotation "+m+"]",metadata:f};o.push(_),m+=1}return"aaa"}));else for(I=h.length,l&&(I=1),label=r.label,Array.isArray(label)&&(label=label[0]["@value"]),C=0;C<I;C++)w=h[C],k={"@id":w["@id"],"@type":"sc:Canvas",label:label+" ["+(C+1)+"]"},o.push(k);case 23:case"end":return e.stop()}}),e)})),I=0;case 36:if(!(I<c.length)){e.next=41;break}return e.delegateYield(y(I),"t1",38);case 38:I++,e.next=36;break;case 41:return this.generating=!0,e.next=44,this.update(f,h);case 44:"error"!==e.sent&&(this.result=!0);case 46:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"create",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(data){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return data.a="b",t="https://api.jsonbin.io/v3/b",e.next=4,y.a.post(t,data,{headers:{"Content-Type":"application/json","X-Master-Key":"$2b$10$unmAqqNkGBsCaaOK3d4QEui0i./fZ0INKty90iDOBMHHRoB.ywT.S","X-Bin-Private":"false"}}).then((function(e){return t.replace("/v3","")+"/"+e.data.metadata.id+"/1"})).catch((function(){return null}));case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"update",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t,data){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.put(t.slice(0,-2),JSON.stringify(data),{headers:{"Content-Type":"application/json","X-Master-Key":"$2b$10$unmAqqNkGBsCaaOK3d4QEui0i./fZ0INKty90iDOBMHHRoB.ywT.S","X-Bin-Private":"false"}}).then((function(){return"success"})).catch((function(){return"error"}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"getCollection",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,o,i,c,l,f,v,h,d,m,y,I;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.collectionProgress=t,e.next=3,this.$utils.getData(t);case 3:if(!(r=e.sent)){e.next=26;break}if(!r.collections){e.next=24;break}o=r.collections,i=0;case 8:if(!(i<o.length)){e.next=22;break}if(!(c=o[i]).manifests){e.next=15;break}for(l=c.manifests,f=0;f<l.length;f++)(v=l[f])["@id"]&&n.push(v["@id"]);e.next=19;break;case 15:return e.next=17,this.getCollection(c["@id"],n);case 17:for(h=e.sent,d=0;d<h.length;d++)n.push(h[d]);case 19:i++,e.next=8;break;case 22:e.next=26;break;case 24:for(m=r.manifests,y=0;y<m.length;y++)(I=m[y])["@id"]&&n.push(I["@id"]);case 26:return e.abrupt("return",n);case 27:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),d}(d.Vue),w=C=_([Object(d.Component)({layout:"conv",components:{}})],C),k=n(58),j=n(88),$=n.n(j),R=n(397),O=n(402),P=n(400),U=n(407),F=n(399),V=n(185),D=n(118),A=n(45),M=n(99),T=n(408),B=n(43),L=n(426),component=Object(k.a)(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-container",{staticClass:"my-10"},[n("h2",{staticClass:"mb-5"},[e._v(e._s(e.$t("Convert IIIF Manifest to Curation")))]),e._v(" "),n("v-sheet",{staticClass:"pa-4 mb-10",attrs:{color:"grey lighten-3"}},["ja"===e.$i18n.locale?[n("ul",[n("li",[e._v("\n            1つ以上のカンバスからotherContentが取得できた場合には、それらに含まれるアノテーション情報のみから構成されるIIIFキュレーションリストに変換します。otherContentが1つも取得できなかった場合には、すべてのカンバス情報をIIIFキュレーションリストに変換します。\n          ")]),e._v(" "),n("li",[e._v("\n            IIIFコレクションの場合、各マニフェストの第1カンバスの情報のみから構成されるIIIFキュレーションリストに変換します。\n          ")])])]:e._e()],2),e._v(" "),n("v-card",{staticClass:"mb-10",attrs:{flat:"",outlined:""}},[n("div",{staticClass:"pa-5"},[n("v-text-field",{attrs:{label:e.$t("Manifest URI"),required:""},model:{value:e.manifest,callback:function(t){e.manifest=t},expression:"manifest"}}),e._v(" "),n("v-btn",{attrs:{color:"primary",href:e.localePath({name:"conv-convert2curation",query:{u:e.manifest}})}},[e._v(e._s(e.$t("Submit")))])],1)]),e._v(" "),e.result?e._e():n("div",[e.manifestDownloaded?n("ul",[n("li",[e._v("\n          1/4 "+e._s(e.$t("IIIF Manifest Downloaded."))+"\n          "),!e.curationUriGenerated&&e.collectionProgress?n("ul",[n("li",[e._v(e._s(e.collectionProgress))])]):e._e()]),e._v(" "),e.curationUriGenerated?n("li",[e._v("\n          2/4 "+e._s(e.$t("Generating Curation URI."))+"\n        ")]):e._e(),e._v(" "),e.manifestProgress?n("li",[e._v("\n          "+e._s(e.manifestProgress)+"\n          "),e.canvasProgress?n("ul",[n("li",[e._v(e._s(e.canvasProgress))])]):e._e()]):e._e(),e._v(" "),e.generating?n("li",[e._v("\n          4/4 "+e._s(e.$t("Generating IIIF Curation List ..."))+"\n        ")]):e._e()]):e._e()]),e._v(" "),e.result?n("div",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2"},[e._v(e._s(e.$t("IIIF Curation List")))]),e._v(" "),n("v-list",[n("v-list-item",{attrs:{href:e.curationUri,target:"_blank"}},[n("v-list-item-icon",[n("img",{attrs:{src:e.baseUrl+"/img/icons/json-ld-data-32.png",width:"30"}})]),e._v(" "),n("v-list-item-content",[n("v-list-item-title",[e._v(e._s(e.$t("IIIF Curation List")))])],1)],1)],1)],1)],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2"},[e._v(e._s(e.$t("Viewer")))]),e._v(" "),n("v-list",e._l(e.viewers,(function(t,r){return n("v-list-item",{key:r,attrs:{href:t.url+e.curationUri,target:"_blank"}},[n("v-list-item-icon",[n("img",{staticStyle:{width:"30px"},attrs:{src:t.icon,width:"30"}})]),e._v("\n                "+e._s(e.$t(t.label))+"\n              ")],1)})),1)],1)],1)],1)],1):e._e()],1)],1)}),[],!1,null,null,null);t.default=component.exports;$()(component,{VBtn:R.a,VCard:O.a,VCardTitle:P.b,VCol:U.a,VContainer:F.a,VList:V.a,VListItem:D.a,VListItemContent:A.a,VListItemIcon:M.a,VListItemTitle:A.b,VRow:T.a,VSheet:B.a,VTextField:L.a})}}]);