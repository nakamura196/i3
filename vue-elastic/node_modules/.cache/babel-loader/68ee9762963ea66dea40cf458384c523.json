{"remainingRequest":"/Users/nakamura/git/d_jps/idj2/vue-elastic/node_modules/babel-loader/lib/index.js!/Users/nakamura/git/d_jps/idj2/vue-elastic/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nakamura/git/d_jps/idj2/vue-elastic/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nakamura/git/d_jps/idj2/vue-elastic/src/components/HelloWorld.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nakamura/git/d_jps/idj2/vue-elastic/src/components/HelloWorld.vue","mtime":1571185448900},{"path":"/Users/nakamura/git/d_jps/idj2/vue-elastic/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/idj2/vue-elastic/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/idj2/vue-elastic/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/idj2/vue-elastic/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/es6.array.sort\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nexport default {\n  name: \"HelloWorld\",\n  data: function data() {\n    return {\n      query: \"\",\n      data: [],\n      currentPage: 1,\n      perPage: 40,\n      access_info: \"\",\n      grid: true,\n      col: 6,\n      sort: \"_score_desc\"\n    };\n  },\n  methods: {\n    search: function search() {\n      var _this = this;\n\n      this.update_param();\n      var query = {\n        query: {\n          bool: {\n            must: [],\n            filter: []\n          }\n        },\n        aggs: {\n          \"accessInfo.keyword\": {\n            terms: {\n              field: \"accessInfo.keyword\",\n              size: 100,\n              order: {\n                _count: \"desc\"\n              }\n            }\n          }\n        },\n        size: this.perPage,\n        from: this.currentPage - 1\n      };\n\n      if (this.query != \"\") {\n        query.query.bool.must.push({\n          match: {\n            label: this.query\n          }\n        });\n      }\n\n      if (this.access_info != \"\") {\n        query.query.bool.filter.push({\n          term: {\n            \"accessInfo.keyword\": this.access_info\n          }\n        });\n      }\n\n      axios.post(\"https://search-nakamura1962-c7fo7icjwe2j6u2qsxf3mp2lda.us-east-2.es.amazonaws.com/idj/_search\", query).then(function (response) {\n        console.log(response.data);\n        _this.data = response.data;\n      });\n    },\n    update_param: function update_param() {\n      var param = {\n        query: this.query,\n        currentPage: this.currentPage,\n        perPage: this.perPage,\n        access_info: this.access_info,\n        col: this.col,\n        grid: this.grid,\n        sort: this.sort\n      };\n      this.$router.push({\n        query: param\n      });\n    }\n  },\n  created: function created() {\n    var param = this.$route.query;\n    this.query = param.query ? param.query : \"\";\n    this.currentPage = param.currentPage ? param.currentPage : 1;\n    this.perPage = param.perPagePage ? param.cperPagePage : 40;\n    this.access_info = param.access_info ? param.access_info : \"\";\n    this.col = param.col ? param.col : 6;\n    this.grid = param.grid == \"false\" ? false : true;\n    this.sort = param.sort ? param.sort : \"_score_desc\";\n    this.search();\n  },\n  watch: {\n    currentPage: function currentPage() {\n      this.update_param();\n      this.search();\n    },\n    access_info: function access_info() {\n      this.update_param();\n      this.search();\n    },\n    perPage: function perPage() {\n      this.update_param();\n      this.search();\n    },\n    col: function col() {\n      this.update_param();\n      this.search();\n    }\n  }\n};",{"version":3,"sources":["HelloWorld.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"bg-light\">\n    <b-navbar toggleable=\"lg\" type=\"dark\" variant=\"info\">\n      <b-navbar-brand href=\"#\">IIIF Discovery in Japan</b-navbar-brand>\n\n      <b-navbar-toggle target=\"nav-collapse\"></b-navbar-toggle>\n\n      <b-collapse id=\"nav-collapse\" is-nav>\n        <b-navbar-nav></b-navbar-nav>\n\n        <!-- Right aligned nav items -->\n        <b-navbar-nav class=\"ml-auto\">\n          <b-nav-form>\n            <b-form-input\n              class=\"mr-sm-2\"\n              placeholder=\"Search\"\n              @keyup.prevent=\"search\"\n              v-model=\"query\"\n            ></b-form-input>\n          </b-nav-form>\n        </b-navbar-nav>\n      </b-collapse>\n    </b-navbar>\n\n    <b-container fluid>\n      <b-row class=\"my-5\">\n        <b-col sm=\"3\">\n          <b-card\n            class=\"mb-4\"\n            v-if=\"data\"\n            v-for=\"(value, index) in data.aggregations\"\n            :key=\"index\"\n            header=\"Institution\"\n          >\n            <b-form-group>\n              <b-form-checkbox\n                v-for=\"(bucket, index) in value.buckets\"\n                v-model=\"access_info\"\n                :key=\"index\"\n                :value=\"bucket.key\"\n                name=\"flavour-3a\"\n              >{{ bucket.key }} ({{bucket.doc_count}})</b-form-checkbox>\n            </b-form-group>\n          </b-card>\n        </b-col>\n        <b-col sm=\"9\">\n          <b-row class=\"mb-4\">\n            <b-col\n              sm=\"6\"\n            >{{(currentPage - 1) * perPage + 1}} - {{currentPage * perPage}} of {{data.hits.total.value}} results</b-col>\n            <b-col sm=\"6\">\n              <b-form inline>\n                <label class=\"mr-sm-2\" for=\"inline-form-custom-select-pref\">Per row:</label>\n\n                <b-form-select\n                  class=\"mb-2 mr-sm-2 mb-sm-0\"\n                  v-model=\"col\"\n                  :options=\"{ 12: '12', 6: '6', 4: '4'}\"\n                  id=\"inline-form-custom-select-pref\"\n                ></b-form-select>\n\n                <!-- \n                <div data-toggle=\"buttons\" class=\"btn-group btn-group-toggle mx-1\">\n                  <label class=\"mx-2\">\n                    <i class=\"fas fa-th-large\"></i>\n                  </label>\n                  <label class=\"mx-2\">\n                    <i class=\"fas fa-th-list\"></i>\n                  </label>\n                </div>\n                -->\n\n                <label class=\"mr-sm-2\" for=\"inline-form-custom-select-pref\">Per page:</label>\n\n                <b-form-select\n                  class=\"mb-2 mr-sm-2 mb-sm-0\"\n                  v-model=\"perPage\"\n                  :options=\"{ 20: '20', 40: '40', 100: '100'}\"\n                  id=\"inline-form-custom-select-pref\"\n                ></b-form-select>\n\n                <label class=\"mr-sm-2\" for=\"inline-form-custom-select-pref\">Sort by:</label>\n\n                <b-form-select\n                  class=\"mb-2 mr-sm-2 mb-sm-0\"\n                  v-model=\"sort\"\n                  :options=\"{ '_score_desc': 'Relevance'}\"\n                  id=\"inline-form-custom-select-pref\"\n                ></b-form-select>\n              </b-form>\n            </b-col>\n          </b-row>\n\n          <b-pagination\n            v-model=\"currentPage\"\n            :total-rows=\"data.hits.total.value\"\n            :per-page=\"perPage\"\n            aria-controls=\"my-table\"\n            align=\"center\"\n            class=\"mb-4\"\n          ></b-pagination>\n\n          <b-row>\n            <b-col :sm=\"(12/col)\" v-if=\"data\" v-for=\"(value, index) in data.hits.hits\" :key=\"index\">\n              <b-card no-body class=\"mb-4\">\n                <b-link :href=\"value._source.url\" target=\"_blank\" style=\"background-color: black;\">\n                  <b-img-lazy\n                    :src=\"value._source.image\"\n                    alt=\"Image 1\"\n                    style=\"display: flex; margin: auto; max-height: 150px; max-width: 100%;\"\n                  ></b-img-lazy>\n                </b-link>\n\n                <b-card-body>\n                  <b-link :href=\"value._source.url\" target=\"_blank\">\n                    <b-card-title>{{value._source.label}}</b-card-title>\n                  </b-link>\n\n                  <b-card-text>{{value._source.accessInfo}}</b-card-text>\n                </b-card-body>\n              </b-card>\n            </b-col>\n          </b-row>\n\n          <b-pagination\n            v-model=\"currentPage\"\n            :total-rows=\"data.hits.total.value\"\n            :per-page=\"perPage\"\n            aria-controls=\"my-table\"\n            align=\"center\"\n            class=\"my-5\"\n          ></b-pagination>\n        </b-col>\n      </b-row>\n    </b-container>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  name: \"HelloWorld\",\n  data() {\n    return {\n      query: \"\",\n      data: [],\n      currentPage: 1,\n      perPage: 40,\n      access_info: \"\",\n      grid: true,\n      col: 6,\n      sort: \"_score_desc\"\n    };\n  },\n  methods: {\n    search() {\n      this.update_param();\n\n      let query = {\n        query: {\n          bool: {\n            must: [],\n            filter: []\n          }\n        },\n        aggs: {\n          \"accessInfo.keyword\": {\n            terms: {\n              field: \"accessInfo.keyword\",\n              size: 100,\n              order: { _count: \"desc\" }\n            }\n          }\n        },\n        size: this.perPage,\n        from: this.currentPage - 1\n      };\n\n      if (this.query != \"\") {\n        query.query.bool.must.push({ match: { label: this.query } });\n      }\n\n      if (this.access_info != \"\") {\n        query.query.bool.filter.push({\n          term: { \"accessInfo.keyword\": this.access_info }\n        });\n      }\n\n      axios\n        .post(\n          \"https://search-nakamura1962-c7fo7icjwe2j6u2qsxf3mp2lda.us-east-2.es.amazonaws.com/idj/_search\",\n          query\n        )\n        .then(response => {\n          console.log(response.data);\n          this.data = response.data;\n        });\n    },\n    update_param() {\n      let param = {\n        query: this.query,\n        currentPage: this.currentPage,\n        perPage: this.perPage,\n        access_info: this.access_info,\n        col: this.col,\n        grid: this.grid,\n        sort: this.sort\n      };\n\n      this.$router.push({ query: param });\n    }\n  },\n  created() {\n    let param = this.$route.query;\n    this.query = param.query ? param.query : \"\";\n    this.currentPage = param.currentPage ? param.currentPage : 1;\n    this.perPage = param.perPagePage ? param.cperPagePage : 40;\n    this.access_info = param.access_info ? param.access_info : \"\";\n    this.col = param.col ? param.col : 6;\n    this.grid = param.grid == \"false\" ? false : true;\n    this.sort = param.sort ? param.sort : \"_score_desc\";\n\n    this.search();\n  },\n  watch: {\n    currentPage: function() {\n      this.update_param();\n      this.search();\n    },\n    access_info: function() {\n      this.update_param();\n      this.search();\n    },\n    perPage: function() {\n      this.update_param();\n      this.search();\n    },\n    col: function() {\n      this.update_param();\n      this.search();\n    }\n  }\n};\n</script>\n"],"sourceRoot":"src/components"}]}