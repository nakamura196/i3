{"remainingRequest":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nakamura/git/d_jps/cj2/vue-elastic/src/components/HelloWorld.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/src/components/HelloWorld.vue","mtime":1571099937539},{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from \"axios\";\nexport default {\n  name: \"HelloWorld\",\n  data() {\n    return {\n      query: \"\",\n      data: [],\n      currentPage: 1,\n      perPage: 40,\n      access_info: \"\",\n      grid: true,\n      col: 6,\n      sort: \"_score_desc\"\n    };\n  },\n  methods: {\n    search() {\n      this.update_param();\n\n      let query = {\n        query: {\n          bool: {\n            must: [],\n            filter: []\n          }\n        },\n        aggs: {\n          \"accessInfo.keyword\": {\n            terms: {\n              field: \"accessInfo.keyword\",\n              size: 100,\n              order: { _count: \"desc\" }\n            }\n          }\n        },\n        size: this.perPage,\n        from: this.currentPage - 1\n      };\n\n      if (this.query != \"\") {\n        query.query.bool.must.push({ match: { label: this.query } });\n      }\n\n      if (this.access_info != \"\") {\n        query.query.bool.filter.push({\n          term: { \"accessInfo.keyword\": this.access_info }\n        });\n      }\n\n      axios\n        .post(\n          \"https://search-nakamura1962-c7fo7icjwe2j6u2qsxf3mp2lda.us-east-2.es.amazonaws.com/idj/_search\",\n          query\n        )\n        .then(response => {\n          console.log(response.data);\n          this.data = response.data;\n        });\n    },\n    update_param() {\n      let param = {\n        query: this.query,\n        currentPage: this.currentPage,\n        perPage: this.perPage,\n        access_info: this.access_info,\n        col: this.col,\n        grid: this.grid,\n        sort: this.sort\n      };\n\n      this.$router.push({ query: param });\n    }\n  },\n  created() {\n    this.search();\n  },\n  watch: {\n    currentPage: function() {\n      this.update_param();\n      this.search();\n    },\n    access_info: function() {\n      this.update_param();\n      this.search();\n    },\n    perPage: function() {\n      this.update_param();\n      this.search();\n    },\n    col: function() {\n      this.update_param();\n      this.search();\n    }\n  }\n};\n",{"version":3,"sources":["HelloWorld.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"HelloWorld.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"hello\">\n    <b-navbar toggleable=\"lg\" type=\"dark\" variant=\"info\">\n      <b-navbar-brand href=\"#\">IIIF Discovery in Japan</b-navbar-brand>\n\n      <b-navbar-toggle target=\"nav-collapse\"></b-navbar-toggle>\n\n      <b-collapse id=\"nav-collapse\" is-nav>\n        <b-navbar-nav></b-navbar-nav>\n\n        <!-- Right aligned nav items -->\n        <b-navbar-nav class=\"ml-auto\">\n          <b-nav-form>\n            <b-form-input\n              class=\"mr-sm-2\"\n              placeholder=\"Search\"\n              @keyup.prevent=\"search\"\n              v-model=\"query\"\n            ></b-form-input>\n          </b-nav-form>\n        </b-navbar-nav>\n      </b-collapse>\n    </b-navbar>\n\n    <b-container fluid>\n      <b-row class=\"my-5\">\n        <b-col cols=\"3\">\n          <b-card class=\"mb-4\" v-if=\"data\" v-for=\"(value, index) in data.aggregations\" :key=\"index\" header=\"Institution\">\n            <b-form-group>\n              <b-form-checkbox\n                v-for=\"(bucket, index) in value.buckets\"\n                v-model=\"access_info\"\n                :key=\"index\"\n                :value=\"bucket.key\"\n                name=\"flavour-3a\"\n              >{{ bucket.key }} ({{bucket.doc_count}})</b-form-checkbox>\n            </b-form-group>\n          </b-card>\n        </b-col>\n        <b-col cols=\"9\">\n\n\n\n          <b-row class=\"mb-4\">\n            <b-col>{{(currentPage - 1) * perPage + 1}} - {{data.hits.total.value}} results found</b-col>\n            <b-col class=\"text-right\">\n              <div class=\"form-inline float-sm-right\">\n                <div class=\"form-group mx-1 py-1\" v-if=\"grid\">\n                  Per row:&nbsp;\n                  <select v-model=\"col\" class=\"form-control\">\n                    <option value=\"12\">12</option>\n                    <option value=\"6\">6</option>\n                    <option value=\"4\">4</option>\n                    <option value=\"2\">2</option>\n                  </select>\n                </div>\n\n                <div data-toggle=\"buttons\" class=\"btn-group btn-group-toggle mx-1\">\n                  <label class=\"mx-2\">\n                    <i class=\"fas fa-th-large\"></i>\n                  </label>\n                  <label class=\"mx-2\">\n                    <i class=\"fas fa-th-list\"></i>\n                  </label>\n                </div>\n\n                <div class=\"form-group mx-1 py-1\">\n                  Per page:&nbsp;\n                  <select v-model=\"perPage\" class=\"form-control\">\n                    <option value=\"20\">20</option>\n                    <option value=\"40\">40</option>\n                    <option value=\"100\">100</option>\n                  </select>\n                </div>\n\n                <div class=\"form-group mx-1 py-1\">\n                  <select v-model=\"sort\" class=\"form-control\">\n                    <option value=\"_score_desc\">Relevance</option>\n                  </select>\n                </div>\n              </div>\n            </b-col>\n          </b-row>\n\n          <b-pagination\n            v-model=\"currentPage\"\n            :total-rows=\"data.hits.total.value\"\n            :per-page=\"perPage\"\n            aria-controls=\"my-table\"\n            align=\"center\"\n            class=\"mb-4\"\n          ></b-pagination>\n\n          <b-row>\n            <b-col\n              :sm=\"(12/col)\"\n              v-if=\"data\"\n              v-for=\"(value, index) in data.hits.hits\"\n              :key=\"index\"\n            >\n              <!-- \n              <b-link :href=\"value._source.url\" target=\"_blank\">\n                <b-card\n                  :title=\"value._source.label\"\n                  :img-src=\"value._source.image\"\n                  img-alt=\"Image\"\n                  img-top\n                  class=\"mb-4\"\n                >\n                  <b-card-text>{{value._source.accessInfo}}</b-card-text>\n                </b-card>\n              </b-link>\n              -->\n\n              <b-card no-body\n              class=\"mb-4\">\n                <b-link :href=\"value._source.url\" target=\"_blank\">\n                <b-img-lazy fluid :src=\"value._source.image\" alt=\"Image 1\"></b-img-lazy>\n                </b-link>\n\n                <b-card-body>\n                  <b-link :href=\"value._source.url\" target=\"_blank\">\n                  <b-card-title>{{value._source.label}}</b-card-title>\n                  </b-link>\n\n                  <b-card-text>{{value._source.accessInfo}}</b-card-text>\n                </b-card-body>\n              </b-card>\n            </b-col>\n          </b-row>\n\n          <b-pagination\n            v-model=\"currentPage\"\n            :total-rows=\"data.hits.total.value\"\n            :per-page=\"perPage\"\n            aria-controls=\"my-table\"\n            align=\"center\"\n            class=\"my-5\"\n          ></b-pagination>\n        </b-col>\n      </b-row>\n    </b-container>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  name: \"HelloWorld\",\n  data() {\n    return {\n      query: \"\",\n      data: [],\n      currentPage: 1,\n      perPage: 40,\n      access_info: \"\",\n      grid: true,\n      col: 6,\n      sort: \"_score_desc\"\n    };\n  },\n  methods: {\n    search() {\n      this.update_param();\n\n      let query = {\n        query: {\n          bool: {\n            must: [],\n            filter: []\n          }\n        },\n        aggs: {\n          \"accessInfo.keyword\": {\n            terms: {\n              field: \"accessInfo.keyword\",\n              size: 100,\n              order: { _count: \"desc\" }\n            }\n          }\n        },\n        size: this.perPage,\n        from: this.currentPage - 1\n      };\n\n      if (this.query != \"\") {\n        query.query.bool.must.push({ match: { label: this.query } });\n      }\n\n      if (this.access_info != \"\") {\n        query.query.bool.filter.push({\n          term: { \"accessInfo.keyword\": this.access_info }\n        });\n      }\n\n      axios\n        .post(\n          \"https://search-nakamura1962-c7fo7icjwe2j6u2qsxf3mp2lda.us-east-2.es.amazonaws.com/idj/_search\",\n          query\n        )\n        .then(response => {\n          console.log(response.data);\n          this.data = response.data;\n        });\n    },\n    update_param() {\n      let param = {\n        query: this.query,\n        currentPage: this.currentPage,\n        perPage: this.perPage,\n        access_info: this.access_info,\n        col: this.col,\n        grid: this.grid,\n        sort: this.sort\n      };\n\n      this.$router.push({ query: param });\n    }\n  },\n  created() {\n    this.search();\n  },\n  watch: {\n    currentPage: function() {\n      this.update_param();\n      this.search();\n    },\n    access_info: function() {\n      this.update_param();\n      this.search();\n    },\n    perPage: function() {\n      this.update_param();\n      this.search();\n    },\n    col: function() {\n      this.update_param();\n      this.search();\n    }\n  }\n};\n</script>\n"]}]}