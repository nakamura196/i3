{"remainingRequest":"/Users/nakamura/git/d_iiif/i3/vue-elastic/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nakamura/git/d_iiif/i3/vue-elastic/src/components/HelloWorld.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nakamura/git/d_iiif/i3/vue-elastic/src/components/HelloWorld.vue","mtime":1571192986659},{"path":"/Users/nakamura/git/d_iiif/i3/vue-elastic/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_iiif/i3/vue-elastic/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_iiif/i3/vue-elastic/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_iiif/i3/vue-elastic/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_iiif/i3/vue-elastic/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from \"axios\";\nexport default {\n  name: \"HelloWorld\",\n  data() {\n    return {\n      query: \"\",\n      data: [],\n      data_: [],\n      currentPage: 1,\n      perPage: 40,\n      access_info: \"\",\n      grid: true,\n      col: 6,\n      sort: \"_score_desc\",\n      forms: [{}],\n      options: []\n    };\n  },\n  methods: {\n    search() {\n      this.update_param();\n\n      let query = {}\n\n      for(var i = 0; i < this.forms.length; i++){\n        let form = this.forms[i]\n        let field = form.label\n        let value = form.value\n        query[field] = value\n      }\n\n      console.log(query)\n\n      this.data_ = []\n      for(var i = 0; i < this.data.length; i++){\n        let obj = this.data[i]\n        let metadata = obj.metadata\n\n        let flg = true\n        for(let key in query){\n          if(!metadata[key] || metadata[key] != query[key]){\n            flg = false\n          }\n        }\n\n        if(flg){\n          this.data_.push(obj)\n        }\n      }\n\n\n      /*\n\n      let query = {\n        query: {\n          bool: {\n            must: [],\n            filter: []\n          }\n        },\n        aggs: {\n          \"accessInfo.keyword\": {\n            terms: {\n              field: \"accessInfo.keyword\",\n              size: 100,\n              order: { _count: \"desc\" }\n            }\n          }\n        },\n        size: this.perPage,\n        from: this.currentPage - 1\n      };\n\n      if (this.query != \"\") {\n        query.query.bool.must.push({ match: { label: this.query } });\n      }\n\n      if (this.access_info != \"\") {\n        query.query.bool.filter.push({\n          term: { \"accessInfo.keyword\": this.access_info }\n        });\n      }\n\n      axios\n        .post(\n          \"https://search-nakamura1962-c7fo7icjwe2j6u2qsxf3mp2lda.us-east-2.es.amazonaws.com/idj/_search\",\n          query\n        )\n        .then(response => {\n          console.log(response.data);\n          this.data = response.data;\n        });\n\n        */\n    },\n    update_param() {\n      /*\n      let param = {\n        query: this.query,\n        currentPage: this.currentPage,\n        perPage: this.perPage,\n        access_info: this.access_info,\n        col: this.col,\n        grid: this.grid,\n        sort: this.sort\n      };\n\n      this.$router.push({ query: param });\n      */\n    },\n    add_form() {\n      this.forms.push({\n        value: \"\"\n      });\n    },\n    compare(){\n      let params = []\n      for(let i = 0; i < this.data.length; i++){\n        let obj = this.data[i]\n        if(obj._checked){\n          params.push(obj._manifest+\"#\"+obj._id)\n        }\n      }\n      let url = \"https://nakamura196.github.io/i3/comp/compare.html?param=\"+encodeURIComponent(params.join(';'));\n      window.open(url, 'compare');\n    }\n  },\n  created() {\n    let curation = \"https://nakamura196.github.io/saji/data/curation.json\";\n    //let curation = \"https://mp.ex.nii.ac.jp/api/curation/json/528810d2-4e28-4a46-910c-c9b517f86943\"\n\n    axios.get(curation).then(response => {\n      console.log(response.data);\n      var arr = [];\n      var selections = response.data.selections;\n      var count = 1;\n      var fields_tmp = [];\n      for (var i = 0; i < selections.length; i++) {\n        var selection = selections[i];\n        var members = selection.members;\n        for (var j = 0; j < members.length; j++) {\n          var member = members[j];\n\n          var obj = {\n            _label: member.label,\n            _url:\n              \"http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?curation=\" +\n              curation +\n              \"&pos=\" +\n              count,\n              _checked: false,\n              _id: member[\"@id\"],\n              _manifest: selection.within[\"@id\"],\n              \"metadata\": {}\n          };\n          count += 1;\n\n          if(member[\"metadata\"]){\n            var metadata = member[\"metadata\"];\n            for (var k = 0; k < metadata.length; k++) {\n              var m = metadata[k];\n              //obj[m.label] = m.value;\n              obj.metadata[m.label] = m.value\n\n              if (fields_tmp.indexOf(m.label) == -1) {\n                fields_tmp.push(m.label);\n              }\n            }\n          }\n          \n\n          if (member[\"thumbnail\"]) {\n            obj[\"_thumbnail\"] = member[\"thumbnail\"];\n          }\n\n          arr.push(obj);\n        }\n      }\n      this.data = arr;\n      this.data_ = arr;\n\n      for (var i = 0; i < fields_tmp.length; i++) {\n        this.options.push({\n          value: fields_tmp[i],\n          text: fields_tmp[i]\n        });\n      }\n\n      console.log(arr);\n    });\n\n    let param = this.$route.query;\n    this.query = param.query ? param.query : \"\";\n    this.currentPage = param.currentPage ? param.currentPage : 1;\n    this.perPage = param.perPagePage ? param.cperPagePage : 40;\n    this.access_info = param.access_info ? param.access_info : \"\";\n    this.col = param.col ? param.col : 6;\n    this.grid = param.grid == \"false\" ? false : true;\n    this.sort = param.sort ? param.sort : \"_score_desc\";\n\n    //this.forms = [];\n\n    //this.search();\n  },\n  watch: {\n    /*\n    currentPage: function() {\n      this.update_param();\n      this.search();\n    },\n    access_info: function() {\n      this.update_param();\n      this.search();\n    },\n    perPage: function() {\n      this.update_param();\n      this.search();\n    },\n    col: function() {\n      this.update_param();\n      this.search();\n    }\n    */\n  }\n};\n",{"version":3,"sources":["HelloWorld.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"HelloWorld.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"bg-light\">\n    <b-navbar toggleable=\"lg\" type=\"dark\" variant=\"info\">\n      <b-navbar-brand href=\"#\">IIIF Curation Comparison Tool</b-navbar-brand>\n    </b-navbar>\n\n    <b-container fluid>\n      <b-row class=\"my-5\">\n        <b-col sm=\"12\">\n\n          <b-row class=\"mb-4\">\n            <b-col\n              sm=\"6\"\n            >{{(currentPage - 1) * perPage + 1}} - {{currentPage * perPage}} of {{data.length}} results</b-col>\n            <b-col sm=\"6\">\n              <b-form inline>\n                <label class=\"mr-sm-2\" for=\"inline-form-custom-select-pref\">Per row:</label>\n\n                <b-form-select\n                  class=\"mb-2 mr-sm-2 mb-sm-0\"\n                  v-model=\"col\"\n                  :options=\"{ 12: '12', 6: '6', 4: '4'}\"\n                  id=\"inline-form-custom-select-pref\"\n                ></b-form-select>\n\n                <label class=\"mr-sm-2\" for=\"inline-form-custom-select-pref\">Per page:</label>\n\n                <b-form-select\n                  class=\"mb-2 mr-sm-2 mb-sm-0\"\n                  v-model=\"perPage\"\n                  :options=\"{ 20: '20', 40: '40', 100: '100'}\"\n                  id=\"inline-form-custom-select-pref\"\n                ></b-form-select>\n\n                <label class=\"mr-sm-2\" for=\"inline-form-custom-select-pref\">Sort by:</label>\n\n                <b-form-select\n                  class=\"mb-2 mr-sm-2 mb-sm-0\"\n                  v-model=\"sort\"\n                  :options=\"{ '_score_desc': 'Relevance'}\"\n                  id=\"inline-form-custom-select-pref\"\n                ></b-form-select>\n              </b-form>\n            </b-col>\n          </b-row>\n\n        <!--\n\n          <b-pagination\n            v-model=\"currentPage\"\n            :total-rows=\"data.hits.total.value\"\n            :per-page=\"perPage\"\n            aria-controls=\"my-table\"\n            align=\"center\"\n            class=\"mb-4\"\n          ></b-pagination>\n\n          -->\n\n          <b-card no-body class=\"mb-4\">\n            <b-card-body>\n              <b-form inline v-for=\"(form, index) in forms\" :key=\"index\">\n                <b-form-select v-model=\"form.label\" :options=\"options\"></b-form-select>\n\n                <b-form-input class=\"mb-2 mr-sm-2 mb-sm-0\" v-model=\"form.value\"></b-form-input>\n              </b-form>\n\n              <b-button variant=\"primary\" @click=\"add_form\">Add</b-button>\n              <b-button variant=\"primary\" @click=\"search\">Search</b-button>\n            </b-card-body>\n          </b-card>\n\n          <b-button variant=\"primary\" @click=\"compare\">Compare</b-button>\n\n          <b-row>\n            <b-col :sm=\"(12/col)\" v-if=\"data_\" v-for=\"(value, index) in data_\" :key=\"index\">\n              <b-card no-body class=\"mb-4\">\n                <b-link :href=\"value._url\" target=\"_blank\" style=\"background-color: black;\">\n                  <b-img-lazy\n                    :src=\"value._thumbnail\"\n                    alt=\"Image 1\"\n                    style=\"display: flex; margin: auto; max-height: 150px; max-width: 100%;\"\n                  ></b-img-lazy>\n                </b-link>\n\n                <b-card-body>\n                  <b-link :href=\"value._url\" target=\"_blank\">\n                    <b-card-title>{{value._label}}</b-card-title>\n                  </b-link>\n                  \n                  <b-card-text>{{value.metadata}}</b-card-text>\n                  \n                  <b-form-checkbox v-model=\"value._checked\" name=\"check-button\" switch>\n    </b-form-checkbox>\n                </b-card-body>\n              </b-card>\n            </b-col>\n          </b-row>\n\n          <!--\n\n          <b-pagination\n            v-model=\"currentPage\"\n            :total-rows=\"data.hits.total.value\"\n            :per-page=\"perPage\"\n            aria-controls=\"my-table\"\n            align=\"center\"\n            class=\"my-5\"\n          ></b-pagination>\n\n          -->\n        </b-col>\n      </b-row>\n    </b-container>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  name: \"HelloWorld\",\n  data() {\n    return {\n      query: \"\",\n      data: [],\n      data_: [],\n      currentPage: 1,\n      perPage: 40,\n      access_info: \"\",\n      grid: true,\n      col: 6,\n      sort: \"_score_desc\",\n      forms: [{}],\n      options: []\n    };\n  },\n  methods: {\n    search() {\n      this.update_param();\n\n      let query = {}\n\n      for(var i = 0; i < this.forms.length; i++){\n        let form = this.forms[i]\n        let field = form.label\n        let value = form.value\n        query[field] = value\n      }\n\n      console.log(query)\n\n      this.data_ = []\n      for(var i = 0; i < this.data.length; i++){\n        let obj = this.data[i]\n        let metadata = obj.metadata\n\n        let flg = true\n        for(let key in query){\n          if(!metadata[key] || metadata[key] != query[key]){\n            flg = false\n          }\n        }\n\n        if(flg){\n          this.data_.push(obj)\n        }\n      }\n\n\n      /*\n\n      let query = {\n        query: {\n          bool: {\n            must: [],\n            filter: []\n          }\n        },\n        aggs: {\n          \"accessInfo.keyword\": {\n            terms: {\n              field: \"accessInfo.keyword\",\n              size: 100,\n              order: { _count: \"desc\" }\n            }\n          }\n        },\n        size: this.perPage,\n        from: this.currentPage - 1\n      };\n\n      if (this.query != \"\") {\n        query.query.bool.must.push({ match: { label: this.query } });\n      }\n\n      if (this.access_info != \"\") {\n        query.query.bool.filter.push({\n          term: { \"accessInfo.keyword\": this.access_info }\n        });\n      }\n\n      axios\n        .post(\n          \"https://search-nakamura1962-c7fo7icjwe2j6u2qsxf3mp2lda.us-east-2.es.amazonaws.com/idj/_search\",\n          query\n        )\n        .then(response => {\n          console.log(response.data);\n          this.data = response.data;\n        });\n\n        */\n    },\n    update_param() {\n      /*\n      let param = {\n        query: this.query,\n        currentPage: this.currentPage,\n        perPage: this.perPage,\n        access_info: this.access_info,\n        col: this.col,\n        grid: this.grid,\n        sort: this.sort\n      };\n\n      this.$router.push({ query: param });\n      */\n    },\n    add_form() {\n      this.forms.push({\n        value: \"\"\n      });\n    },\n    compare(){\n      let params = []\n      for(let i = 0; i < this.data.length; i++){\n        let obj = this.data[i]\n        if(obj._checked){\n          params.push(obj._manifest+\"#\"+obj._id)\n        }\n      }\n      let url = \"https://nakamura196.github.io/i3/comp/compare.html?param=\"+encodeURIComponent(params.join(';'));\n      window.open(url, 'compare');\n    }\n  },\n  created() {\n    let curation = \"https://nakamura196.github.io/saji/data/curation.json\";\n    //let curation = \"https://mp.ex.nii.ac.jp/api/curation/json/528810d2-4e28-4a46-910c-c9b517f86943\"\n\n    axios.get(curation).then(response => {\n      console.log(response.data);\n      var arr = [];\n      var selections = response.data.selections;\n      var count = 1;\n      var fields_tmp = [];\n      for (var i = 0; i < selections.length; i++) {\n        var selection = selections[i];\n        var members = selection.members;\n        for (var j = 0; j < members.length; j++) {\n          var member = members[j];\n\n          var obj = {\n            _label: member.label,\n            _url:\n              \"http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?curation=\" +\n              curation +\n              \"&pos=\" +\n              count,\n              _checked: false,\n              _id: member[\"@id\"],\n              _manifest: selection.within[\"@id\"],\n              \"metadata\": {}\n          };\n          count += 1;\n\n          if(member[\"metadata\"]){\n            var metadata = member[\"metadata\"];\n            for (var k = 0; k < metadata.length; k++) {\n              var m = metadata[k];\n              //obj[m.label] = m.value;\n              obj.metadata[m.label] = m.value\n\n              if (fields_tmp.indexOf(m.label) == -1) {\n                fields_tmp.push(m.label);\n              }\n            }\n          }\n          \n\n          if (member[\"thumbnail\"]) {\n            obj[\"_thumbnail\"] = member[\"thumbnail\"];\n          }\n\n          arr.push(obj);\n        }\n      }\n      this.data = arr;\n      this.data_ = arr;\n\n      for (var i = 0; i < fields_tmp.length; i++) {\n        this.options.push({\n          value: fields_tmp[i],\n          text: fields_tmp[i]\n        });\n      }\n\n      console.log(arr);\n    });\n\n    let param = this.$route.query;\n    this.query = param.query ? param.query : \"\";\n    this.currentPage = param.currentPage ? param.currentPage : 1;\n    this.perPage = param.perPagePage ? param.cperPagePage : 40;\n    this.access_info = param.access_info ? param.access_info : \"\";\n    this.col = param.col ? param.col : 6;\n    this.grid = param.grid == \"false\" ? false : true;\n    this.sort = param.sort ? param.sort : \"_score_desc\";\n\n    //this.forms = [];\n\n    //this.search();\n  },\n  watch: {\n    /*\n    currentPage: function() {\n      this.update_param();\n      this.search();\n    },\n    access_info: function() {\n      this.update_param();\n      this.search();\n    },\n    perPage: function() {\n      this.update_param();\n      this.search();\n    },\n    col: function() {\n      this.update_param();\n      this.search();\n    }\n    */\n  }\n};\n</script>\n"]}]}