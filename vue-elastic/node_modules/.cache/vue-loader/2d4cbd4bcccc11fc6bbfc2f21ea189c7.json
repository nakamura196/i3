{"remainingRequest":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nakamura/git/d_jps/cj2/vue-elastic/src/components/HelloWorld.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/src/components/HelloWorld.vue","mtime":1571068184021},{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nakamura/git/d_jps/cj2/vue-elastic/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from \"axios\";\nexport default {\n  name: \"HelloWorld\",\n  data() {\n    return {\n      query: \"百鬼夜行図\",\n      data: [],\n      currentPage: 1,\n      perPage: 40,\n      access_info: \"\"\n    };\n  },\n  methods: {\n    search() {\n      console.log(this.currentPage);\n\n      let query = {\n        \"query\": {\n          /*\n          query_string: {\n            default_field: \"label\",\n            query: this.query\n          }\n          */\n          bool: {\n            \"must\" : [\n              {\n                \"match\" : {\n            \"label\" : {\n                \"query\" : this.query\n            }\n        }\n              }\n              /*,\n              {\n                term: {\n                  \"accessInfo.keyword\": this.access_info\n                }\n              }\n              */\n           ],\n           \n           \"filter\" : [ \n        //{ \"term\":  { \"accessInfo.keyword\": this.access_info }}\n      ]\n    \n          }\n        },\n        aggs: {\n          \"accessInfo.keyword\": {\n            terms: {\n              field: \"accessInfo.keyword\",\n              size: 5,\n              order: { _count: \"desc\" }\n            }\n          }\n        },\n        size: this.perPage,\n        from: this.currentPage - 1\n      };\n\n      if(this.access_info != \"\"){\n        query.query.bool.filter.push({ \"term\":  { \"accessInfo.keyword\": this.access_info }})\n      }\n\n      axios\n        .post(\n          \"https://search-nakamura1962-c7fo7icjwe2j6u2qsxf3mp2lda.us-east-2.es.amazonaws.com/idj/_search\",\n          query\n        )\n        .then(response => {\n          console.log(response.data);\n          this.data = response.data;\n        });\n    }\n  },\n  created() {\n    this.search();\n  },\n  watch: {\n    currentPage: function() {\n      this.search();\n      this.$route.query.currentPage = this.currentPage\n    },\n    access_info: function() {\n      this.search();\n    },\n    '$route' () {\n      console.log(this.$route.query)\n      /*\n        if (this.$route.query.q != \"\") {\n            this.term = this.$route.query.q\n        }\n        */\n    }\n  }\n};\n",{"version":3,"sources":["HelloWorld.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"HelloWorld.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"hello\">\n    <b-navbar toggleable=\"lg\" type=\"dark\" variant=\"info\">\n      <b-navbar-brand href=\"#\">IIIF Discovery in Japan</b-navbar-brand>\n\n      <b-navbar-toggle target=\"nav-collapse\"></b-navbar-toggle>\n\n      <b-collapse id=\"nav-collapse\" is-nav>\n        <b-navbar-nav></b-navbar-nav>\n\n        <!-- Right aligned nav items -->\n        <b-navbar-nav class=\"ml-auto\">\n          <b-nav-form>\n            <b-form-input\n              class=\"mr-sm-2\"\n              placeholder=\"Search\"\n              @keyup.prevent=\"search\"\n              v-model=\"query\"\n            ></b-form-input>\n          </b-nav-form>\n        </b-navbar-nav>\n      </b-collapse>\n    </b-navbar>\n\n    <b-container fluid>\n      <b-row class=\"my-5\">\n        <b-col cols=\"3\">\n          <b-card class=\"mb-4\" v-if=\"data\" v-for=\"(value, index) in data.aggregations\" :key=\"index\">\n            <b-form-group label=\"Access Info\">\n              <b-form-checkbox\n                v-for=\"(bucket, index) in value.buckets\"\n                v-model=\"access_info\"\n                :key=\"index\"\n                :value=\"bucket.key\"\n                name=\"flavour-3a\"\n              >{{ bucket.key }} ({{bucket.doc_count}})</b-form-checkbox>\n            </b-form-group>\n          </b-card>\n        </b-col>\n        <b-col cols=\"9\">\n          <b-row class=\"mb-4\">\n            <b-col>{{data.hits.total.value}} results found</b-col>\n            <b-col class=\"text-right\">\n              <div class=\"form-inline float-sm-right\">\n                <div class=\"form-group mx-1\">\n                  Per row:&nbsp;\n                  <select class=\"form-control\">\n                    <option value=\"12\">12</option>\n                    <option value=\"6\">6</option>\n                    <option value=\"4\">4</option>\n                    <option value=\"2\">2</option>\n                  </select>\n                </div>\n                <div data-toggle=\"buttons\" class=\"btn-group btn-group-toggle mx-1\">\n                  <label class=\"mx-2\">\n                    <i class=\"fas fa-th-large\"></i>\n                  </label>\n                  <label class=\"mx-2\">\n                    <i class=\"fas fa-th-list\"></i>\n                  </label>\n                </div>\n                <div class=\"form-group mx-1\">\n                  Per page:&nbsp;\n                  <select class=\"form-control\">\n                    <option value=\"20\">20</option>\n                    <option value=\"50\">50</option>\n                    <option value=\"100\">100</option>\n                  </select>\n                </div>\n                <div class=\"form-group mx-1\">\n                  <select class=\"form-control\">\n                    <option value=\"_score_desc\">Relevance</option>\n                    <option value=\"Title Asc\">Title Asc</option>\n                    <option value=\"Title Desc\">Title Desc</option>\n                  </select>\n                </div>\n              </div>\n            </b-col>\n          </b-row>\n\n          <b-row>\n            <b-col cols=\"3\" v-if=\"data\" v-for=\"(value, index) in data.hits.hits\" :key=\"index\">\n              <b-link :href=\"value._source.url\" target=\"_blank\">\n                <b-card\n                  :title=\"value._source.label\"\n                  :img-src=\"value._source.image\"\n                  img-alt=\"Image\"\n                  img-height=\"200px\"\n                  img-top\n                  class=\"mb-4\"\n                ></b-card>\n              </b-link>\n            </b-col>\n          </b-row>\n\n          <b-pagination\n            v-model=\"currentPage\"\n            :total-rows=\"data.hits.total.value\"\n            :per-page=\"perPage\"\n            aria-controls=\"my-table\"\n          ></b-pagination>\n        </b-col>\n      </b-row>\n    </b-container>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  name: \"HelloWorld\",\n  data() {\n    return {\n      query: \"百鬼夜行図\",\n      data: [],\n      currentPage: 1,\n      perPage: 40,\n      access_info: \"\"\n    };\n  },\n  methods: {\n    search() {\n      console.log(this.currentPage);\n\n      let query = {\n        \"query\": {\n          /*\n          query_string: {\n            default_field: \"label\",\n            query: this.query\n          }\n          */\n          bool: {\n            \"must\" : [\n              {\n                \"match\" : {\n            \"label\" : {\n                \"query\" : this.query\n            }\n        }\n              }\n              /*,\n              {\n                term: {\n                  \"accessInfo.keyword\": this.access_info\n                }\n              }\n              */\n           ],\n           \n           \"filter\" : [ \n        //{ \"term\":  { \"accessInfo.keyword\": this.access_info }}\n      ]\n    \n          }\n        },\n        aggs: {\n          \"accessInfo.keyword\": {\n            terms: {\n              field: \"accessInfo.keyword\",\n              size: 5,\n              order: { _count: \"desc\" }\n            }\n          }\n        },\n        size: this.perPage,\n        from: this.currentPage - 1\n      };\n\n      if(this.access_info != \"\"){\n        query.query.bool.filter.push({ \"term\":  { \"accessInfo.keyword\": this.access_info }})\n      }\n\n      axios\n        .post(\n          \"https://search-nakamura1962-c7fo7icjwe2j6u2qsxf3mp2lda.us-east-2.es.amazonaws.com/idj/_search\",\n          query\n        )\n        .then(response => {\n          console.log(response.data);\n          this.data = response.data;\n        });\n    }\n  },\n  created() {\n    this.search();\n  },\n  watch: {\n    currentPage: function() {\n      this.search();\n      this.$route.query.currentPage = this.currentPage\n    },\n    access_info: function() {\n      this.search();\n    },\n    '$route' () {\n      console.log(this.$route.query)\n      /*\n        if (this.$route.query.q != \"\") {\n            this.term = this.$route.query.q\n        }\n        */\n    }\n  }\n};\n</script>\n"]}]}