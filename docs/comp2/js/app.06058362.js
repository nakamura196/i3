(function(t){function e(e){for(var r,n,o=e[0],l=e[1],c=e[2],h=0,m=[];h<o.length;h++)n=o[h],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&m.push(s[n][0]),s[n]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(m.length)m.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(r=!1)}r&&(i.splice(e--,1),t=n(n.s=a[0]))}return t}var r={},s={app:0},i=[];function n(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=r,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var r=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},i=[],n={name:"app"},o=n,l=a("2877"),c=Object(l["a"])(o,s,i,!1,null,null,null),u=c.exports,h=a("5f5b"),m=a("bc3a"),f=a.n(m),b=a("a7fe"),d=a.n(b),g=a("8c4f"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-light"},[a("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[a("b-navbar-brand",{attrs:{href:"#"}},[t._v("IIIF Curation Comparison Tool")])],1),a("b-container",{attrs:{fluid:""}},[a("b-row",{staticClass:"my-5"},[a("b-col",{attrs:{sm:"3"}},t._l(t.data.aggregations,(function(e,r){return a("b-card",{directives:[{name:"show",rawName:"v-show",value:e.buckets.length>0,expression:"agg.buckets.length > 0"}],key:r,staticClass:"mb-4",attrs:{header:r}},[a("b-button",{staticClass:"mb-3",attrs:{type:"button",size:"sm",variant:"outline-secondary"},on:{click:t.search}},[a("i",{staticClass:"fas fa-search"}),t._v(" Search\n          ")]),a("b-form-group",t._l(t.query.aggs[r].flg?e.buckets:e.buckets.slice(0,t.facet_show_size),(function(e,s){return a("b-form-checkbox",{key:s,attrs:{value:e.key,name:"flavour-3a"},model:{value:t.query.aggs[r].value,callback:function(e){t.$set(t.query.aggs[r],"value",e)},expression:"query.aggs[label].value"}},[t._v("\n              "+t._s(e.key)+"\n              "),a("b-badge",[t._v(t._s(e.doc_count.toLocaleString()))])],1)})),1),a("div",{staticClass:"text-right"},[e.buckets.length>t.facet_show_size?a("b-button",{attrs:{type:"button",variant:"link",size:"sm"},on:{click:function(e){t.query.aggs[r].flg=!t.query.aggs[r].flg}}},[t.query.aggs[r].flg?[t._v("Show less")]:[t._v("Show more "+t._s(e.buckets.length-t.facet_show_size)+" items")]],2):t._e()],1)],1)})),1),a("b-col",{attrs:{sm:"9"}},[a("b-row",{staticClass:"mb-4"},[a("b-col",{staticClass:"mb-2",attrs:{sm:"12"}},[t._v(t._s(t.total>0?((t.currentPage-1)*t.perPage+1).toLocaleString():0)+" - "+t._s(t.currentPage*t.perPage>t.total?t.total.toLocaleString():(t.currentPage*t.perPage).toLocaleString())+" of "+t._s(t.total.toLocaleString())+" results")]),a("b-col",{attrs:{sm:"12"}},[a("b-form",{attrs:{inline:""}},[a("label",{staticClass:"mr-sm-2",attrs:{for:"inline-form-custom-select-pref"}},[t._v("Per page:")]),a("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{options:{20:"20",50:"50",100:"100"},id:"inline-form-custom-select-pref"},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}}),a("label",{staticClass:"mr-sm-2",attrs:{for:"inline-form-custom-select-pref"}},[t._v("Sort by:")]),a("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{options:t.sort_options,id:"inline-form-custom-select-pref"},model:{value:t.sort,callback:function(e){t.sort=e},expression:"sort"}}),a("b-form-group",[a("b-form-radio-group",{staticClass:"mr-sm-2",attrs:{options:t.d_options,buttons:"","button-variant":"outline-primary"},model:{value:t.grid,callback:function(e){t.grid=e},expression:"grid"}})],1),a("label",{directives:[{name:"show",rawName:"v-show",value:"grid"==t.grid,expression:"grid == 'grid'"}],staticClass:"mr-sm-2",attrs:{for:"inline-form-custom-select-pref"}},[t._v("Per row:")]),a("b-form-select",{directives:[{name:"show",rawName:"v-show",value:"grid"==t.grid,expression:"grid == 'grid'"}],staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{options:{12:"12",6:"6",4:"4"},id:"inline-form-custom-select-pref"},model:{value:t.col,callback:function(e){t.col=e},expression:"col"}})],1)],1)],1),a("b-card",{staticClass:"mb-4",attrs:{"no-body":""}},[a("b-card-body",[t._l(t.forms,(function(e,r){return a("b-row",{key:r,staticClass:"my-2"},[a("b-col",{attrs:{sm:"4"}},[a("b-form-select",{attrs:{options:t.advanced_search_options},model:{value:e.label,callback:function(a){t.$set(e,"label",a)},expression:"form.label"}})],1),a("b-col",{attrs:{sm:"8"}},[a("b-form-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"form.value"}})],1)],1)})),a("b-button",{staticClass:"my-2",on:{click:t.add_form}},[t._v("Add")]),a("br"),a("b-button",{staticClass:"my-2",attrs:{variant:"primary"},on:{click:t.search}},[t._v("Search")])],2)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"table"!=t.grid,expression:"grid != 'table'"}],staticClass:"text-right mb-4"},[a("b-button",{staticClass:"my-2 mr-2",attrs:{variant:"info"},on:{click:t.compare}},[t._v("Compare")]),a("b-button",{staticClass:"my-2 mr-2",on:{click:t.select_all}},[t._v("Select All")]),a("b-button",{staticClass:"my-2 mr-2",on:{click:t.deselect_all}},[t._v("Unselect All")]),a("b-button",{staticClass:"my-2",attrs:{variant:"info",href:"https://nakamura196.github.io/i3/comp/compare2.html?curation="+t.$route.query.curation,target:"compare"}},[t._v("Compare All")])],1),t.total>0?a("b-pagination",{staticClass:"mb-4",attrs:{"total-rows":t.total,"per-page":t.perPage,"aria-controls":"my-table",align:"center"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e(),a("b-row",{directives:[{name:"show",rawName:"v-show",value:"grid"==t.grid,expression:"grid == 'grid'"}]},t._l(t.hits,(function(e,r){return a("b-col",{key:r,attrs:{sm:12/t.col}},[a("b-card",{staticClass:"mb-4",attrs:{"no-body":""}},[a("b-link",{staticStyle:{"background-color":"black"},attrs:{href:e._url,target:"_blank"}},[e._thumbnail?a("b-img-lazy",{staticStyle:{display:"flex",margin:"auto","max-height":"150px","max-width":"100%"},attrs:{src:e._thumbnail,alt:"Image 1"}}):t._e()],1),a("b-card-body",[a("b-link",{attrs:{href:e._url,target:"_blank"}},[a("b-card-title",[t._v(t._s(e._label))])],1),a("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:e._checked,callback:function(a){t.$set(e,"_checked",a)},expression:"value._checked"}})],1)],1)],1)})),1),t._l(t.hits,(function(e,r){return a("b-card",{directives:[{name:"show",rawName:"v-show",value:"list"==t.grid,expression:"grid == 'list'"}],key:r,staticClass:"mb-4",attrs:{"no-body":""}},[a("b-card-body",[a("b-row",[a("b-col",{attrs:{sm:"3"}},[a("b-link",{attrs:{href:e._url,target:"_blank"}},[e._thumbnail?a("b-img-lazy",{staticStyle:{"max-height":"150px","max-width":"100%"},attrs:{src:e._thumbnail,alt:"Image 1"}}):t._e()],1)],1),a("b-col",{attrs:{sm:"9"}},[a("b-link",{attrs:{href:e._url,target:"_blank"}},[a("b-card-title",[t._v(t._s(e._label))])],1),a("b-card-text",[t._v(t._s(e.metadata))]),a("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:e._checked,callback:function(a){t.$set(e,"_checked",a)},expression:"value._checked"}})],1)],1)],1)],1)})),a("b-table",{directives:[{name:"show",rawName:"v-show",value:"table"==t.grid,expression:"grid == 'table'"}],staticClass:"mb-4",attrs:{striped:"",hover:"",fields:t.fields,items:t.items,responsive:""},scopedSlots:t._u([{key:"cell(_label)",fn:function(e){return[a("b-link",{attrs:{href:e.item._url,target:"_blank"}},[a("b",[t._v(t._s(e.item._label))])])]}},{key:"cell()",fn:function(e){return[t._v(t._s(e.value))]}}])}),t.total>0?a("b-pagination",{staticClass:"mb-4",attrs:{"total-rows":t.total,"per-page":t.perPage,"aria-controls":"my-table",align:"center"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],2)],1)],1),t._m(0)],1)},v=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",{staticClass:"bd-footer text-muted"},[a("div",{staticClass:"container"},[a("hr"),a("p",{staticClass:"mt-4 pb-5 text-center"},[a("a",{attrs:{href:"https://researchmap.jp/nakamura.satoru/?lang=english"}},[t._v("Satoru Nakamura")])])])])}],_=(a("a481"),a("456d"),a("ac6a"),a("ffc1"),a("28a5"),a("386d"),a("96cf"),a("3b8d")),y=(a("55dd"),a("c5f6"),{name:"HelloWorld",data:function(){return{data:[],currentPage:1,perPage:20,grid:"grid",col:4,sort:"_score_desc",total:0,hits:[],query:{aggs:{},q:""},facet_show_size:10,search_flg:!1,hits_all:[],forms:[{}],advanced_search_options:[],d_options:[{text:"Grid",value:"grid"},{text:"List",value:"list"},{text:"Table",value:"table"}],df_map:{},sort_options:[],mani_arr:{},curation:"",fields:[{name:"Label",key:"_label"}],items:[]}},mounted:function(){var t=this.$route.query;this.query=t.query?JSON.parse(t.query):this.query,this.currentPage=t.currentPage?Number(t.currentPage):this.currentPage,this.perPage=t.perPage?Number(t.perPage):this.perPage,this.col=t.col?Number(t.col):this.col,this.grid=t.grid?t.grid:this.grid,this.sort=t.sort?t.sort:this.sort,this.curation=t.curation,this.init_curation(this.curation)},methods:{init_curation:function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(e){var a,r,s,i,n,o,l,c,u,h,m,b,d,g,p,v,_,y,k,w,x,P,C;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f.a.get(e);case 2:for(a=t.sent,r=[],s=a.data.selections,i=1,n=[],o={},l=0;l<s.length;l++)for(c=s[l],u=c.members,h=0;h<u.length;h++){if(m=u[h],b={_label:m.label,_url:"http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?curation="+e+"&pos="+i,_checked:!1,_id:m["@id"],_manifest:c.within["@id"],metadata:{}},i+=1,m["metadata"])for(d=m["metadata"],g=0;g<d.length;g++)p=d[g],v=p.label,_=p.value,b.metadata[v]=_,-1==n.indexOf(v)&&n.push(v),o[v]||(o[v]={}),y=o[v],y[_]||(y[_]=[]),y[_].push(r.length);m["thumbnail"]?b["_thumbnail"]=m["thumbnail"]:b["_thumbnail"]=this.get_thumbnails(b),r.push(b)}for(this.hits_all=r,l=0;l<n.length;l++)k=n[l],this.advanced_search_options.push({value:k,text:k}),this.fields.push(k),this.sort_options.push({value:k+"_asc",text:k+" Asc"}),0==l&&(this.sort=k+"_asc"),this.sort_options.push({value:k+"_desc",text:k+" Desc"});for(x in w={},o)for(C in P=o[x],w[x]=[],P)w[x].push({key:C,value:P[C]});this.df_map=w,this.init();case 15:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),init:function(){for(var t=[],e=0;e<this.advanced_search_options.length;e++){this.advanced_search_options[e];t.push({label:this.advanced_search_options[e].text,field:this.advanced_search_options[e].text})}for(var a={},r=0;r<t.length;r++){var s=t[r].label,i={field:t[r].field,flg:!1},n=[];this.query.aggs[s]&&(n=this.query.aggs[s].value),i.value=n,a[s]=i}this.query.aggs=a,this.search(),this.search_flg=!0},search:function(){this.update_param();var t={query:{bool:{must:[],filter:[]}},aggs:{},size:this.perPage,from:this.currentPage-1};for(var e in this.query.aggs){var a=this.query.aggs[e];t.aggs[e]={terms:{field:a.field,size:50,order:{_count:"desc"}}}}if(""!=this.query.q)for(var r=this.query.q,s=r.split("ã€€").join(" ").split(" "),i=0;i<s.length;i++){var n=s[i];t.query.bool.must.push({match_phrase:{label:n}})}var o=this.query.aggs;for(var l in o){var c=o[l]["value"];if(c.length>0){var u=[];t.query.bool.filter.push({bool:{should:u}});for(var h=0;h<c.length;h++){var m={};m[o[l].field]=c[h],u.push({term:m})}}}this.es(t)},es:function(t){for(var e=t.query.bool.filter,a={},r=0;r<e.length;r++)for(var s=e[r],i=s.bool.should,n=0;n<i.length;n++){var o=i[n].term,l=Object.entries(o)[0],c=l[0],u=l[1];a[c]||(a[c]=[]),a[c].push(u)}for(r=0;r<this.forms.length;r++){var h=this.forms[r],m=h.label,f=h.value;""!=f&&null!=f&&(a[m]=[f])}var b=this.sort.split("_"),d=b[0],g=b[1],p=this.df_map[d];"asc"==g?p.sort((function(t,e){return e.key<t.key?1:e.key>t.key?-1:0})):p.sort((function(t,e){return e.key>t.key?1:e.key<t.key?-1:0}));for(var v=[],_=0;_<p.length;_++)for(var y=p[_].value,k=0;k<y.length;k++){var w=y[k];-1==v.indexOf(w)&&v.push(w)}var x=[],P={};for(r=0;r<v.length;r++){var C=v[r],q=this.hits_all[C],S=q.metadata,j=!0;for(var O in a){var N=a[O];if(S[O]){if(N.length>0){for(var $=!1,z=0;z<N.length;z++)-1!=S[O].indexOf(N[z])&&($=!0);$||(j=!1)}}else j=!1}if(j)for(var L in x.push(q),S){var I=S[L];P[L]||(P[L]={});var A=P[L];A[I]||(A[I]=0),A[I]+=1}}this.data=x;var T={},J=function(t){var e=[],a=P[t],r=Object.keys(a).map((function(t){return{key:t,value:a[t]}}));r.sort((function(t,e){return t.value<e.value?1:t.value>e.value?-1:0}));for(var s=0;s<r.length;s++){var i=r[s],n={key:i.key,doc_count:i.value};e.push(n)}T[t]={buckets:e}};for(var M in P)J(M);var E=x.length;this.total=E;for(var R=this.perPage,U=this.currentPage,D=[],F=(U-1)*R,G=U*R>E?E:U*R,H=[],W=F;W<G;W++){var B=x[W];D.push(B);var K={};for(var Q in K._url=B._url,K._label=B._label,B.metadata)K[Q]=B.metadata[Q];H.push(K)}this.items=H;var V={hits:D,total:{relation:"gte",value:x.length}},X={aggregations:T,hits:V};this.data=X,this.hits=V.hits},update_param:function(){var t={query:JSON.stringify(this.query),currentPage:this.currentPage,perPage:this.perPage,col:this.col,grid:this.grid,sort:this.sort,curation:this.curation};this.$router.replace({name:"home",query:t},(function(){}),(function(){}))},add_form:function(){this.forms.push({value:""})},compare:function(){for(var t=[],e=0;e<this.hits.length;e++){var a=this.hits[e];a._checked&&t.push(a._manifest+"#"+a._id)}var r="https://nakamura196.github.io/i3/comp/compare.html?param="+encodeURIComponent(t.join(";"));window.open(r,"compare")},select_all:function(){for(var t=0;t<this.hits.length;t++){var e=this.hits[t];e._checked=!0}},deselect_all:function(){for(var t=0;t<this.hits.length;t++){var e=this.hits[t];e._checked=!1}},get_thumbnails:function(t){var e=this,a=t._manifest;if(this.mani_arr[a])return t._thumbnail=this.get_thumbnail(t),t._thumbnail;f.a.get(a).then((function(r){var s=r.data,i={};e.mani_arr[a]=i;for(var n=s["sequences"][0]["canvases"],o=0;o<n.length;o++){var l=n[o];l["images"][0]["resource"]["service"]?i[l["@id"]]=l["images"][0]["resource"]["service"]["@id"]+"/info.json":i[l["@id"]]=l["images"][0]["resource"]["@id"]}return t._thumbnail=e.get_thumbnail(t),t._thumbnail}))},get_thumbnail:function(t){var e=t._id.split("#xywh="),a=e[0],r=e[1],s=this.mani_arr[t._manifest][a];return-1!=s.indexOf("info.json")&&(s=s.replace("info.json",r+"/200,/0/default.jpg")),s}},watch:{currentPage:function(){this.search_flg&&this.search(),this.update_param()},perPage:function(){this.search_flg&&this.search(),this.update_param()},col:function(){this.update_param()}}}),k=y,w=Object(l["a"])(k,p,v,!1,null,null,null),x=w.exports;r["default"].use(g["a"]);var P=new g["a"]({routes:[{path:"/",name:"home",component:x}]});a("f9e3"),a("2dd8");r["default"].use(h["a"],f.a,d.a),r["default"].config.productionTip=!1,new r["default"]({router:P,render:function(t){return t(u)}}).$mount("#app")}});
//# sourceMappingURL=app.06058362.js.map